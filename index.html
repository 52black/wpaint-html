<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
<title>绘制页面</title>
<link rel="stylesheet" href="./app.css">
</head>
<body>
<div id="stage" class="stage">
<div class="container">
<div class="sidebar" aria-label="右侧栏">
<div class="toolbar-right" aria-label="工具栏">
  <div class="toolbar-row" aria-label="画笔">
    <button id="pen" class="tool-btn tool-pen" title="铅笔" aria-label="铅笔"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4Z"/></svg></span></button>
    <button id="pen2" class="tool-btn tool-pen2" title="钢笔" aria-label="钢笔"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg></span></button>
    <button id="blobby" class="tool-btn tool-icon" title="毛团笔" aria-label="毛团笔"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21c-4.5 0-8-3.2-8-7.6C4 8.8 7.5 6 10.6 6c.8-2 2.3-3 4-3 2.1 0 3.8 1.5 4.2 3.8C20.9 7.7 22 9.5 22 12c0 5-4 9-10 9Z"/></svg></span></button>
  </div>
  <div class="toolbar-row" aria-label="画笔（第二行）">
    <button id="stippleTiny" class="tool-btn tool-icon" title="颗粒笔" aria-label="颗粒笔"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="currentColor"><circle cx="7" cy="7" r="1.2"/><circle cx="12" cy="6" r="1"/><circle cx="17" cy="7.5" r="1.1"/><circle cx="6" cy="12" r="1"/><circle cx="11" cy="12" r="1.3"/><circle cx="16.5" cy="12.5" r="1"/><circle cx="7.5" cy="17" r="1.1"/><circle cx="12.5" cy="18" r="1"/><circle cx="18" cy="17" r="1.2"/></svg></span></button>
    <button id="softLrg" class="tool-btn tool-icon" title="柔边笔" aria-label="柔边笔"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M12 3v3"/><path d="M21 12h-3"/><path d="M12 21v-3"/><path d="M3 12h3"/><path d="M18.4 5.6l-2.1 2.1"/><path d="M7.7 16.3l-2.1 2.1"/><path d="M5.6 5.6l2.1 2.1"/><path d="M16.3 16.3l2.1 2.1"/></svg></span></button>
    <button id="eraser" class="tool-btn tool-eraser" title="橡皮擦" aria-label="橡皮擦"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 20H9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19H4a2 2 0 0 1-2-2v-1l11.5-12.5Z"/></svg></span></button>
  </div>
  <div class="toolbar-row" aria-label="历史">
    <button id="undo" class="tool-btn tool-undo tool-icon" title="撤销" aria-label="撤销"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 4v6h6" transform="rotate(45 6 10)"/><path d="M21 17a9 9 0 0 0-9-9H3"/></svg></span></button>
    <button id="redo" class="tool-btn tool-redo tool-icon" title="重做" aria-label="重做"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 4v6h-6" transform="rotate(-45 20 6)"></path><path d="M3 17a9 9 0 0 1 9-9h9"/></svg></span></button>
    <button id="clear" class="tool-btn tool-clear tool-icon" title="清空" aria-label="清空"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M8 6V4h8v2"/><path d="M19 6l-1 16H6L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg></span></button>
  </div>
  <div class="toolbar-row" aria-label="操作">
    <button id="switchColor" class="tool-btn tool-color tool-icon" title="换色" aria-label="换色"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a9 9 0 1 0 0 18c2.2 0 3-1 3-2.5S14 16 12.5 16H12a2 2 0 0 1 0-4h1.2c1.9 0 3.8-1.5 3.8-4.2A4.8 4.8 0 0 0 12 3Z"/><path d="M7.5 10.5h.01"/><path d="M9.5 7.5h.01"/><path d="M14.5 7.5h.01"/><path d="M16.5 10.5h.01"/></svg></span></button>
    <button id="advanced" class="tool-btn tool-advanced tool-icon" title="高级" aria-label="高级"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="2" y1="14" x2="6" y2="14"/><line x1="10" y1="8" x2="14" y2="8"/><line x1="18" y1="16" x2="22" y2="16"/></svg></span></button>
    <div class="file-menu-wrap">
      <button id="fileMenuToggle" type="button" class="tool-btn tool-icon" title="文件" aria-label="文件" aria-haspopup="menu" aria-expanded="false"><span class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7a2 2 0 0 1 2-2h5l2 2h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg></span></button>
      <div id="fileMenu" class="file-menu" role="menu" aria-label="文件操作">
        <button id="openProject" class="tool-btn" role="menuitem">打开</button>
        <button id="saveAs" class="tool-btn" role="menuitem">另存为</button>
        <button id="exportGif" class="tool-btn tool-export" role="menuitem">导出GIF</button>
        <button id="importGif" class="tool-btn tool-importgif" role="menuitem">导入GIF</button>
        <button id="importBg" class="tool-btn tool-importbg" role="menuitem">导入背景</button>
        <button id="clearBg" class="tool-btn" role="menuitem">清除背景</button>
      </div>
    </div>
  </div>
</div>
<div class="toolbar-left" aria-label="颜色与图案">
  <div class="pattern-picker" aria-label="图案设置">
    <button id="patternSelect" type="button" class="pattern-select" aria-haspopup="dialog" aria-expanded="false">
      <canvas id="patternThumb" class="thumb" width="18" height="18"></canvas>
      <span id="patternSelectLabel">默认图案</span>
    </button>
    <div id="patternPopover" class="pattern-popover" role="dialog" aria-label="图案选择">
      <div id="patternList" class="pattern-list" aria-label="图案列表"></div>
      <div id="patternStage" class="pattern-stage" aria-label="图案编辑">
        <div class="row">
          <button id="patternUpload" type="button" class="action-btn">上传</button>
          <button id="patternDelete" type="button" class="action-btn">删除</button>
        </div>
        <div id="patternEdit" class="pattern-edit">
          <div class="pattern-preview"><canvas id="patternPreview" width="32" height="32"></canvas></div>
          <div style="display:grid;gap:8px;">
            <button id="patternInvert" type="button" class="action-btn">反色</button>
            <button id="patternConfirm" type="button" class="action-btn">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="paletteTools" class="palette-panel" aria-label="16色调色板笔"></div>
  <button id="paletteMoreToggle" type="button" class="action-btn palette-more-btn">更多</button>
  <button id="paletteCollapse" type="button" class="action-btn palette-collapse-btn" style="display:none;">收起</button>
</div>
<div class="sidebar-footer" aria-label="底部按钮">
  <button id="settingsFooterBtn" type="button" class="action-btn" title="设置" aria-label="设置"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.6 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.6a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></button>
  <button id="animBtn" type="button" class="action-btn" title="动画" aria-label="动画"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V6l12 6-12 6Z"/><path d="M3 6v12"/></svg></button>
  <button id="layerBtn" type="button" class="action-btn" title="图层" aria-label="图层"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2 3 7l9 5 9-5-9-5Z"/><path d="M3 12l9 5 9-5"/><path d="M3 17l9 5 9-5"/></svg></button>
  <button id="cropBtn" type="button" class="action-btn" title="裁剪" aria-label="裁剪"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2v14a2 2 0 0 0 2 2h14"/><path d="M18 22V8a2 2 0 0 0-2-2H2"/></svg></button>
  <button id="selectBtn" type="button" class="action-btn" title="选择" aria-label="选择"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="2" ry="2" stroke-dasharray="4 3"/></svg></button>
  <div class="zoom-menu-wrap">
    <button id="zoomBtn" type="button" class="action-btn" title="画布缩放" aria-label="画布缩放" aria-haspopup="dialog" aria-expanded="false"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.3-4.3"/><path d="M11 8v6"/><path d="M8 11h6"/></svg></button>
    <div id="zoomMenu" class="zoom-menu" role="dialog" aria-label="画布缩放">
      <div class="row">
        <button id="zoomOut" type="button" class="action-btn zoom-icon-btn" aria-label="缩小"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/></svg></button>
        <div class="zoom-controls">
          <input id="canvasZoom" type="range" min="50" max="300" step="10" value="100" aria-label="画布缩放百分比">
          <span id="canvasZoomValue" class="pill" style="font-size: 12px;">100%</span>
        </div>
        <button id="zoomIn" type="button" class="action-btn zoom-icon-btn" aria-label="放大"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"/><path d="M5 12h14"/></svg></button>
      </div>
      <div class="row">
      <label class="toggle"><input id="canvasPanMode" type="checkbox"><span>拖动内容</span></label>
      <button id="zoomFit" type="button" class="action-btn zoom-icon-btn" aria-label="自适应缩放"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 3H3v6"/><path d="M15 3h6v6"/><path d="M9 21H3v-6"/><path d="M15 21h6v-6"/></svg></button>
      <button id="zoomReset" type="button" class="action-btn zoom-icon-btn" aria-label="重置为100%" style="font-size: 12px;">100%</button>
      </div>
    </div>
  </div>
</div>
<div id="cropPanel" class="crop-panel" role="region" aria-label="裁剪">
  <div class="head">
    <strong>裁剪</strong>
    <div class="actions">
      <button id="cropCancel" type="button" class="action-btn">取消</button>
      <button id="cropApply" type="button" class="action-btn">应用</button>
    </div>
  </div>
  <label class="toggle" style="justify-content:space-between;"><span>允许扩展画布</span><input id="cropAllowExtend" type="checkbox"></label>
  <div class="grid">
    <div class="cell"><label for="cropLeft">左</label><input id="cropLeft" type="number" step="1" value="0"></div>
    <div class="cell"><label for="cropRight">右</label><input id="cropRight" type="number" step="1" value="0"></div>
    <div class="cell"><label for="cropTop">上</label><input id="cropTop" type="number" step="1" value="0"></div>
    <div class="cell"><label for="cropBottom">下</label><input id="cropBottom" type="number" step="1" value="0"></div>
  </div>
  <div id="cropHint" class="hint">提示：输入负数表示向外扩展画布（左右最多各扩展 100% 宽度）</div>
  <button id="cropAuto" type="button" class="action-btn crop-auto-btn">自动识别</button>
</div>
<div id="selectPanel" class="select-panel" role="region" aria-label="选择">
  <div class="row">
    <button id="selectCopy" type="button" class="action-btn">复制</button>
    <button id="selectCut" type="button" class="action-btn">剪切</button>
    <button id="selectPaste" type="button" class="action-btn">粘贴</button>
  </div>
  <div class="row">
    <button id="selectUndo" class="action-btn" type="button" title="撤销" aria-label="撤销">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 4v6h6" transform="rotate(45 6 10)"/><path d="M21 17a9 9 0 0 0-9-9H3"/></svg>
    </button>
    <button id="selectRedo" class="action-btn" type="button" title="重做" aria-label="重做">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 4v6h-6" transform="rotate(-45 20 6)"></path><path d="M3 17a9 9 0 0 1 9-9h9"/></svg>
    </button>
  </div>
  <div class="row">
    <label class="toggle" style="width:100%;justify-content:space-between;"><span>保持比例</span><input id="selectKeepRatio" type="checkbox"></label>
  </div>
  <div class="row">
    <label class="toggle" style="width:100%;justify-content:space-between;"><span>透明背景</span><input id="selectTransparent" type="checkbox"></label>
  </div>
  <div class="row">
    <button id="selectClear" type="button" class="action-btn">取消选区</button>
    <button id="selectExit" type="button" class="action-btn">退出选择</button>
  </div>
</div>
<div id="layerPanel" class="layer-panel" role="region" aria-label="图层">
  <div class="head">
    <strong>图层</strong>
    <div class="actions">
      <button id="layerExit" type="button" class="action-btn icon-only" title="关闭" aria-label="关闭">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg>
      </button>
    </div>
  </div>
  <div class="row">
    <button id="layerAdd" type="button" class="action-btn icon-only" title="新增图层" aria-label="新增图层">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
    </button>
    <button id="layerDelete" type="button" class="action-btn icon-only" title="删除图层" aria-label="删除图层">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M8 6V4h8v2"/><path d="M19 6l-1 16H6L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
    </button>
    <button id="layerMergeDown" type="button" class="action-btn icon-only" title="合并到下方" aria-label="合并到下方">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v10"/><path d="M8 9l4 4 4-4"/><path d="M4 17h16"/><path d="M7 21h10"/></svg>
    </button>
  </div>
  <div class="row">
    <button id="layerUp" type="button" class="action-btn icon-only" title="上移" aria-label="上移">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19V5"/><path d="M5 12l7-7 7 7"/></svg>
    </button>
    <button id="layerDown" type="button" class="action-btn icon-only" title="下移" aria-label="下移">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"/><path d="M19 12l-7 7-7-7"/></svg>
    </button>
  </div>
<div id="layerList" class="layer-list" aria-label="图层列表"></div>
</div>
</div>
<div class="jitter-panel">
  <div id="jitterControls">
    <div class="row">
      <label class="toggle"><input id="jitterOn" type="checkbox" checked><span>抖动</span></label>
      <div class="range">
        <input id="jitter" type="range" min="0" max="10" step="1" value="1" style="width:80px">
        <span id="jitterValue" class="pill">1</span>
      </div>
    </div>
    <div class="row">
      <span class="label">内部延时(ms)</span>
      <input id="jitterDelay" type="number" min="20" step="10" value="120">
    </div>
  </div>
  <div id="eraserControls" style="display:none">
    <div class="row">
      <label class="toggle"><input id="eraseOnlyOutline" type="checkbox"><span>只擦勾线</span></label>
    </div>
    <div class="row">
      <label class="toggle"><input id="eraseOnlyEraser" type="checkbox"><span>不擦勾线</span></label>
    </div>
  </div>
  <div class="row">
    <label class="toggle"><input id="protectOutline" type="checkbox" checked><span>勾线笔不允许被覆盖</span></label>
  </div>
  <div class="row">
    <span class="label">粗细</span>
    <div class="range">
      <input id="size" type="range" min="1" max="64" step="1" value="1">
      <span id="sizeValue" class="pill">1</span>
    </div>
  </div>
</div>
<input id="patternFile" type="file" accept="image/*" style="display:none">
<input id="gifFile" type="file" accept="image/gif" style="display:none">
<input id="wpaintFile" type="file" accept=".wpaint,.deck" style="display:none">
<input id="bgFile" type="file" accept="image/*" style="display:none">
<div id="canvasViewport" class="canvas-viewport">
  <div id="checkerboard" class="checkerboard"></div>
  <div id="canvasBg" class="canvas-bg"></div>
  <canvas id="drawing" class="canvas" width="360" height="342"></canvas>
  <div id="cropOverlay" class="crop-overlay" aria-hidden="true">
    <div id="cropOverlayContent" class="crop-overlay-content">
      <div id="cropShadeTop" class="crop-shade"></div>
      <div id="cropShadeLeft" class="crop-shade"></div>
      <div id="cropShadeRight" class="crop-shade"></div>
      <div id="cropShadeBottom" class="crop-shade"></div>
      <div id="cropRect" class="crop-rect"></div>
    </div>
  </div>
  <div id="selectOverlay" class="select-overlay" aria-hidden="true">
    <div id="selectOverlayContent" class="select-overlay-content">
      <div id="selectRect" class="select-rect"></div>
      <div class="select-handle" data-h="nw"></div>
      <div class="select-handle" data-h="n"></div>
      <div class="select-handle" data-h="rot"></div>
      <div class="select-handle" data-h="ne"></div>
      <div class="select-handle" data-h="e"></div>
      <div class="select-handle" data-h="se"></div>
      <div class="select-handle" data-h="s"></div>
      <div class="select-handle" data-h="sw"></div>
      <div class="select-handle" data-h="w"></div>
    </div>
  </div>
</div>
<div id="colorPage" class="overlay">
  <div class="color-header">
    <span></span>
    <div class="color-actions">
      <label class="toggle"><input type="checkbox" id="toggleTransparent"><span>透明背景</span></label>
      <label class="toggle"><input id="separateOutline" type="checkbox"><span>区分勾线笔颜色</span></label>
      <button id="back" class="action-btn">返回绘制</button>
    </div>
  </div>
  <div class="color-layout">
    <div class="color-side">
      <div class="card">
        <div class="preview-wrap">
          <div id="previewBg" class="preview-bg">
            <canvas id="preview" class="preview-canvas" width="152" height="112"></canvas>
          </div>
        </div>
        <div id="schemeList" class="scheme-list" aria-label="配色方案列表"></div>
      </div>
    </div>
    <div class="card">
      <div class="color-grid-head">
        <button id="schemeReset" type="button" class="action-btn">重置</button>
        <button id="schemeSave" type="button" class="action-btn">保存</button>
      </div>
      <div id="outlineColors" class="outline-colors">
        <div class="mini" title="勾线笔 1">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4Z"/></svg>
          <input type="color" data-index="17">
        </div>
        <div class="mini" title="勾线笔 2">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg>
          <input type="color" data-index="18">
        </div>
        <div class="mini" title="勾线笔 3">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21c-4.5 0-8-3.2-8-7.6C4 8.8 7.5 6 10.6 6c.8-2 2.3-3 4-3 2.1 0 3.8 1.5 4.2 3.8C20.9 7.7 22 9.5 22 12c0 5-4 9-10 9Z"/></svg>
          <input type="color" data-index="19">
        </div>
        <div class="mini" title="勾线笔 4">
          <svg viewBox="0 0 24 24" fill="currentColor"><circle cx="7" cy="7" r="1.2"/><circle cx="12" cy="6" r="1"/><circle cx="17" cy="7.5" r="1.1"/><circle cx="6" cy="12" r="1"/><circle cx="11" cy="12" r="1.3"/><circle cx="16.5" cy="12.5" r="1"/><circle cx="7.5" cy="17" r="1.1"/><circle cx="12.5" cy="18" r="1"/><circle cx="18" cy="17" r="1.2"/></svg>
          <input type="color" data-index="20">
        </div>
        <div class="mini" title="勾线笔 5">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M12 3v3"/><path d="M21 12h-3"/><path d="M12 21v-3"/><path d="M3 12h3"/><path d="M18.4 5.6l-2.1 2.1"/><path d="M7.7 16.3l-2.1 2.1"/><path d="M5.6 5.6l2.1 2.1"/><path d="M16.3 16.3l2.1 2.1"/></svg>
          <input type="color" data-index="21">
        </div>
      </div>
      <div class="color-grid">
        <div class="color-cell"><span class="role">背景色</span><input type="color" data-index="1"></div>
        <div class="color-cell"><span class="role">前景色</span><input type="color" data-index="2"></div>
        <div class="color-cell"><input type="color" data-index="3"></div>
        <div class="color-cell"><input type="color" data-index="4"></div>
        <div class="color-cell"><input type="color" data-index="5"></div>
        <div class="color-cell"><input type="color" data-index="6"></div>
        <div class="color-cell"><input type="color" data-index="7"></div>
        <div class="color-cell"><input type="color" data-index="8"></div>
        <div class="color-cell"><input type="color" data-index="9"></div>
        <div class="color-cell"><input type="color" data-index="10"></div>
        <div class="color-cell"><input type="color" data-index="11"></div>
        <div class="color-cell"><input type="color" data-index="12"></div>
        <div class="color-cell"><input type="color" data-index="13"></div>
        <div class="color-cell"><input type="color" data-index="14"></div>
        <div class="color-cell"><input type="color" data-index="15"></div>
        <div class="color-cell"><input type="color" data-index="16"></div>
      </div>
    </div>
</div>
</div>
<div id="resizeModal" class="modal-overlay" role="dialog" aria-modal="true" aria-label="清空并调整画布尺寸">
  <div class="modal-card">
    <div class="modal-head">
      <strong>清空/新画布</strong>
      <button id="resizeClose" type="button" class="action-btn">关闭</button>
    </div>
    <div class="modal-body">
      <div id="clearAllLayersWrap" class="modal-field" style="display:none;">
        <label class="toggle" style="justify-content:space-between;width:100%;">
          <span>清空所有图层</span>
          <input id="clearAllLayers" type="checkbox">
        </label>
      </div>
      <div id="resizeGrid" class="modal-form-grid">
        <label class="modal-field">
          <span>宽</span>
          <input id="resizeW" class="modal-input" type="number" min="1" max="1000" step="1">
        </label>
        <label class="modal-field">
          <span>高</span>
          <input id="resizeH" class="modal-input" type="number" min="1" max="750" step="1">
        </label>
      </div>
      <div class="modal-actions">
        <button id="resizeCancel" type="button" class="action-btn">取消</button>
        <button id="resizeApply" type="button" class="action-btn">清空并应用</button>
      </div>
    </div>
  </div>
</div>
<div id="settingsModal" class="modal-overlay" role="dialog" aria-modal="true" aria-label="设置">
  <div class="modal-card">
    <div class="modal-head">
      <strong>设置</strong>
      <button id="settingsClose" type="button" class="action-btn">关闭</button>
    </div>
    <div class="modal-body">
      <div class="settings-tabs" role="tablist" aria-label="设置分页">
        <button id="settingsTabGeneral" type="button" class="action-btn is-active" role="tab" aria-selected="true" aria-controls="settingsPageGeneral">设置</button>
        <button id="settingsTabAbout" type="button" class="action-btn" role="tab" aria-selected="false" aria-controls="settingsPageAbout">关于</button>
        <button id="settingsTabShortcuts" type="button" class="action-btn desktop-only" role="tab" aria-selected="false" aria-controls="settingsPageShortcuts">快捷键</button>
      </div>
      <div id="settingsPageGeneral" class="settings-page" role="tabpanel" aria-labelledby="settingsTabGeneral">
        <div class="modal-field">
          <span>UI主题</span>
          <div style="display:flex;gap:10px;flex-wrap:wrap;">
            <label class="toggle" style="justify-content:space-between;">
              <span>默认</span>
              <input id="uiThemeDefault" name="uiTheme" type="radio" value="default">
            </label>
            <label class="toggle" style="justify-content:space-between;">
              <span>可爱</span>
              <input id="uiThemeCute" name="uiTheme" type="radio" value="cute">
            </label>
            <label class="toggle" style="justify-content:space-between;">
              <span>小猫</span>
              <input id="uiThemeCat" name="uiTheme" type="radio" value="cat">
            </label>
          </div>
        </div>
        <div class="modal-field">
          <span>声音</span>
          <label class="toggle" style="justify-content:space-between;">
            <span>开启音效</span>
            <input id="soundEnabled" type="checkbox" checked>
          </label>
        </div>
        <div class="modal-field">
          <span>输入</span>
          <label class="toggle" style="justify-content:space-between;">
            <span>触摸数字键盘</span>
            <input id="numPadEnabled" type="checkbox">
          </label>
        </div>
        <div class="modal-field">
          <span>全屏</span>
          <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
            <button id="fullscreenToggle" type="button" class="action-btn">进入全屏</button>
            <span id="fullscreenState" style="font-size:12px;opacity:.75;"></span>
          </div>
        </div>
      </div>
      <div id="settingsPageAbout" class="settings-page" role="tabpanel" aria-labelledby="settingsTabAbout" hidden>
        <div class="modal-field">
          <span>关于</span>
          <div style="display:grid;gap:4px;">
            <div>名称：WPaint</div>
            <div>作者：雪风与梦 (网名)</div>
            <div>使用部分代码 wigglypaint（作者:Internet Janitor，John Earnest）</div>
          </div>
        </div>
      </div>
      <div id="settingsPageShortcuts" class="settings-page desktop-only" role="tabpanel" aria-labelledby="settingsTabShortcuts" hidden>
        <div class="modal-field">
          <span>说明</span>
          <div style="display:grid;gap:4px;">
            <div>点击某个快捷键后，按下新的组合键即可替换</div>
          </div>
        </div>
        <div class="modal-field">
          <span>快捷键</span>
          <div style="display:grid;gap:8px;">
            <div id="shortcutsList" class="settings-shortcuts"></div>
            <div style="display:flex;justify-content:flex-end;">
              <button id="shortcutsReset" type="button" class="action-btn">恢复默认</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div id="animModal" class="modal-overlay" role="dialog" aria-modal="true" aria-label="动画">
  <div class="modal-card anim-card">
    <div class="modal-head">
      <strong>动画</strong>
      <div class="anim-row">
        <button id="animPlayClose" type="button" class="action-btn">播放并关闭</button>
        <button id="animClose" type="button" class="action-btn">关闭</button>
      </div>
    </div>
    <div class="anim-bar">
      <div class="anim-row">
        <button id="animNewFrame" type="button" class="action-btn">新建帧</button>
        <button id="animDeleteFrame" type="button" class="action-btn">删除帧</button>
        <button id="animMultiSelect" type="button" class="action-btn">多选</button>
        <button id="animPlay" type="button" class="action-btn">播放</button>
      </div>
    </div>
    <div id="animFrameList" class="anim-frames" aria-label="帧列表"></div>
    <div class="anim-row" style="margin-top:10px;">
      <span class="label">持续时间(ms)</span>
      <input id="animDelay" type="number" min="30" step="10" value="360">
      <button id="animApplyAllDelay" type="button" class="action-btn">应用到所有帧</button>
      <button id="animExportGif" type="button" class="action-btn">导出GIF</button>
    </div>
  </div>
</div>
</div>
</div>

<div id="touchHint" class="touch-hint" role="status" aria-live="polite"></div>
<script type="module" src="/src/main.js"></script>
</body>
</html>
